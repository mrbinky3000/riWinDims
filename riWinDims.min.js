/*!
 * riWinDims
 *
 * This jQuery plugin helps developers debug and present responsive website
 * prototypes to peers and clients.  It displays the current window dimensions, a
 * scan-able QR code, and options to resize the browser window.
 *
 * When this was first created, there were very few browser plugins for responsive
 * web design. Now, there are plenty of plugins and scriptlets. However, your
 * client may not have them installed and you may not want to complicate things by
 * requiring your client to install them before viewing your work.
 *
 *
 * @version 0.1.2
 * @date 8/22/2012
 * @author Matthew Toledo, John Keber
 * @require jQuery v1.5+
 */
(function(a){a.riWinDims=function(e,b){var i={sizeMap:[{unique:"fueg",menu:0,start:0,end:319,name:"small / text"},{unique:"fumv",menu:1,start:320,end:320,name:"iPhone Portrait",height:480},{unique:"lknj",menu:0,start:321,end:479,name:"&lt; iPhone Landscape"},{unique:"n4js",menu:1,start:480,end:480,name:"iPone Landscape",height:320},{unique:"n0ep",menu:0,start:481,end:599,name:"&lt; Kindle Nook"},{unique:"4p3z",menu:1,start:600,end:600,name:"Kindle Nook Portrait",height:800},{unique:"m1bs",menu:0,start:601,end:767,name:"&lt; iPad Portrait"},{unique:"2ouh",menu:1,start:768,end:768,name:"iPad Portrait",height:1024},{unique:"cmth",menu:0,start:769,end:799,name:"&lt; Kindle Nook Landscape"},{unique:"39pc",menu:1,start:800,end:800,name:"Kindle Nook Landscape",height:600},{unique:"ndue",menu:0,start:801,end:959,name:"&lt; iPad Landscape"},{unique:"3p7d",menu:1,start:960,end:960,name:"960px",height:680},{unique:"lmup",menu:0,start:961,end:1023,name:"&lt; iPad Landscape"},{unique:"izho",menu:1,start:1024,end:1024,name:"iPad Landscape",height:768},{unique:"tb1d",menu:0,start:1025,end:9999,name:"Generic Desktop"}],qrCode:"https://chart.googleapis.com/chart?cht=qr&chs=100x100&chl="+encodeURI(document.URL)+"&chld=L",breakPointUL:"#ri-breakpoint-menu",htmlTemplate:"ri-windims-menu.html",steps:3,delay:333},g=this,d=a(e),f,c,h;g.showResizer=function(){a("#ri-sizer").html("-");a("#ri-winDims").addClass("ri-full-opacity");a("#ri-sizes").stop(true,true).slideDown();};g.hideResizer=function(){a("#ri-sizer").html("+");a("#ri-winDims").removeClass("ri-full-opacity");a("#ri-sizes").stop(true,true).slideUp();};g.getDims=function(){c=parseInt(a(window).width(),10);h=parseInt(a(window).height(),10);};g.updateWinDims=function(){var p,k=a(g.settings.breakPointUL),l=g.settings.sizeMap.length-1,n,j,m=0;k.find("li a").removeClass("ri-bold");while(l>0){n=g.settings.sizeMap[l];p=n.menu;if(c>=n.start&&c<=n.end){k.find("a[data-unique="+n.unique+"]").addClass("ri-bold");j=n.name;m=m+1;}l=l-1;}a("#ri-winH").html(h);a("#ri-winW").html(c);a("#ri-screen").html(j);};g.getByUnique=function(l){var k=g.settings.sizeMap.length-1;while(k>=0){if(g.settings.sizeMap[k].unique===l){return g.settings.sizeMap[k];}k-=1;}throw new Error("No such sizeMap item with given unique id of "+l);};g.animateResize=function(q,t,s,n,p,m){var j,r,o,l=1,k=function(){var u,v,y,x;if(window.outerWidth){y=window.outerWidth-a(window).width();x=window.outerHeight-a(window).height();}if(l===p){window.clearInterval(j);window.resizeTo(s+y,n+x);g.getDims();g.updateWinDims();return;}u=y+q+(r*l);v=x+t+(o*l);l+=1;window.resizeTo(u,v);};r=Math.floor((s-q)/p);o=Math.floor((n-t)/p);j=window.setInterval(function(){k();},m);};g.firstInit=function(){var r,k,l=g.settings.sizeMap.length-1,p,n,m,j;g.getDims();a.ajax({url:g.settings.htmlTemplate,dataType:"html",success:function(o){a("body").data("riWinDims",true).prepend(o);k=a(g.settings.breakPointUL);while(l>0){p=g.settings.sizeMap[l];if(1===p.menu){r=a('<li><a class="ri-resizer" data-unique="'+p.unique+'" href="#">('+p.start+"px) "+p.name+"</a></li>");k.append(r);}l=l-1;}if("string"===typeof g.settings.qrCode){a("#ri-QR img").attr("src",g.settings.qrCode);}else{a("#ri-QR").remove();}g.updateWinDims();a(window).on("resize.riWinDims",function(){g.getDims();g.updateWinDims();});a(window).on("load.riWinDims",function(){g.getDims();g.updateWinDims();});},error:function(){throw new Error("riWinDims was unable to load the html template.");}});try{n=window.opener.document;}catch(q){}if(n){m=a("body",window.opener.document).data("windims-width");j=a("body",window.opener.document).data("windims-height");g.animateResize(c,h,m,j,10,100);}a(".ri-resizer").live("click",function(w){var o=c,v=h,u=g.getByUnique(a(this).data("unique")),t=u.start,s=u.height;w.preventDefault();if(!n){a("body").attr({"data-windims-width":t,"data-windims-height":s});window.open(document.URL,"__blank__","width=200,height=300,location=yes,menubar=no,links=no,scrollbars=yes,toolbar=no,status=no");}else{g.getDims();g.animateResize(o,v,t,s,g.settings.steps,g.settings.delay);g.hideResizer();}return false;});a("#ri-sizer").live("click",function(o){o.preventDefault();if(a("#ri-sizes").is(":hidden")){g.showResizer();}else{g.hideResizer();}return false;});a("#ri-locate").live("click",function(o){o.preventDefault();var s=a(this);s=a(o.target);if(s.attr("data-arrow")==="d"){a("#ri-winDims").css({top:"auto",bottom:"0"});s.attr("data-arrow","u");s.html("&#9650;");}else{a("#ri-winDims").css({top:"0",bottom:"auto"});s.attr("data-arrow","d");s.html("&#9660;");}return false;});};g.settings={};g.init=function(){g.settings=a.extend({},i,b);if(!a("body").data("riWinDims")){g.firstInit();}else{throw new Error("You can only use this plugin once per page.");}};g.destroy=function(){a(window).unbind(".riWinDims");a(document).unbind(".riWinDims");d.remove();};g.init();};a.fn.riWinDims=function(b){return this.each(function(){if(undefined===a(this).data("riWinDims")){var c=new a.riWinDims(this,b);a(this).data("riWinDims",c);}});};}(jQuery));
