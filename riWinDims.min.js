/*!
 * riWinDims
 *
 * This jQuery plugin helps developers debug and present responsive website
 * prototypes to peers and clients.  It displays the current window dimensions, a
 * scan-able QR code, and options to resize the browser window.
 *
 * When this was first created, there were very few browser plugins for responsive
 * web design. Now, there are plenty of plugins and scriptlets. However, your
 * client may not have them installed and you may not want to complicate things by
 * requiring your client to install them before viewing your work.
 *
 *
 * @version 0.1.0
 * @date 8/20/2012
 * @author Matthew Toledo, John Keber
 * @require jQuery v1.5+
 */
(function(a){a.riWinDims=function(e,b){var h={sizeMap:[{unique:"fueg",menu:0,start:0,end:319,name:"small / text"},{unique:"fumv",menu:1,start:320,end:320,name:"iPhone Portrait",height:480},{unique:"lknj",menu:0,start:321,end:479,name:"&lt; iPhone Landscape"},{unique:"n4js",menu:1,start:480,end:480,name:"iPone Landscape",height:320},{unique:"n0ep",menu:0,start:481,end:599,name:"&lt; Kindle Nook"},{unique:"4p3z",menu:1,start:600,end:600,name:"Kindle Nook Portrait",height:800},{unique:"m1bs",menu:0,start:601,end:767,name:"&lt; iPad Portrait"},{unique:"2ouh",menu:1,start:768,end:768,name:"iPad Portrait",height:1024},{unique:"cmth",menu:0,start:769,end:799,name:"&lt; Kindle Nook Landscape"},{unique:"39pc",menu:1,start:800,end:800,name:"Kindle Nook Landscape",height:600},{unique:"ndue",menu:0,start:801,end:959,name:"&lt; iPad Landscape"},{unique:"3p7d",menu:1,start:960,end:960,name:"960px",height:680},{unique:"lmup",menu:0,start:961,end:1023,name:"&lt; iPad Landscape"},{unique:"izho",menu:1,start:1024,end:1024,name:"iPad Landscape",height:768},{unique:"tb1d",menu:0,start:1025,end:9999,name:"Generic Desktop"}],qrCode:"https://chart.googleapis.com/chart?cht=qr&chs=100x100&chl="+encodeURI(document.URL)+"&chld=L",breakPointUL:"#ri-breakpoint-menu",htmlTemplate:"ri-windims-menu.html"},f=this,d=a(e),c,g;f.showResizer=function(){a("#ri-sizer").html("-");a("#ri-winDims").addClass("ri-full-opacity");a("#ri-sizes").stop(true,true).slideDown();};f.hideResizer=function(){a("#ri-sizer").html("+");a("#ri-winDims").removeClass("ri-full-opacity");a("#ri-sizes").stop(true,true).slideUp();};f.getDims=function(){c=parseInt(a(window).width(),10);g=parseInt(a(window).height(),10);};f.updateWinDims=function(){var p,k=a(f.settings.breakPointUL),l=f.settings.sizeMap.length-1,n,j,m=0;k.find("li a").removeClass("ri-bold");while(l>0){n=f.settings.sizeMap[l];p=n.menu;if(c>=n.start&&c<=n.end){k.find("a[data-unique="+n.unique+"]").addClass("ri-bold");j=n.name;m=m+1;}l=l-1;}a("#ri-winH").html(g);a("#ri-winW").html(c);a("#ri-screen").html(j);};f.getByUnique=function(k){var i=f.settings.sizeMap.length-1;while(i>=0){if(f.settings.sizeMap[i].unique===k){return f.settings.sizeMap[i];}i-=1;}throw new Error("No such sizeMap item with given unique id of "+k);};f.animateResize=function(q,t,s,n,p,m){var j,r,o,l=1,k=function(){var i,u,x,v;if(window.outerWidth){x=window.outerWidth-a(window).width();v=window.outerHeight-a(window).height();}if(l===p){window.clearInterval(j);window.resizeTo(s+x,n+v);f.getDims();f.updateWinDims();return;}i=x+q+(r*l);u=v+t+(o*l);l+=1;window.resizeTo(i,u);};r=Math.floor((s-q)/p);o=Math.floor((n-t)/p);j=window.setInterval(function(){k();},m);};f.firstInit=function(){var p,k,l=f.settings.sizeMap.length-1,n,m,j;f.getDims();a.ajax({url:f.settings.htmlTemplate,dataType:"html",success:function(i){a("body").data("riWinDims",true).prepend(i);k=a(f.settings.breakPointUL);while(l>0){n=f.settings.sizeMap[l];if(1===n.menu){p=a('<li><a class="ri-resizer" data-unique="'+n.unique+'" href="#">('+n.start+"px) "+n.name+"</a></li>");k.append(p);}l=l-1;}if("string"===typeof f.settings.qrCode){a("#ri-QR img").attr("src",f.settings.qrCode);}else{a("#ri-QR").remove();}f.updateWinDims();a(window).on("resize.riWinDims",function(){f.getDims();f.updateWinDims();});a(window).on("load.riWinDims",function(){f.getDims();f.updateWinDims();});},error:function(){throw new Error("riWinDims was unable to load the html template.");}});if(window.opener){m=a("body",window.opener.document).data("windims-width");j=a("body",window.opener.document).data("windims-height");f.animateResize(c,g,m,j,10,100);}a(".ri-resizer").live("click",function(v){var i=c,u=g,s=f.getByUnique(a(this).data("unique")),q=s.start,o=s.height,r=30,t=Math.floor(900/r);v.preventDefault();if(!window.opener){a("body").attr({"data-windims-width":q,"data-windims-height":o});window.open(document.URL,"__blank__","width=200,height=300,location=yes,menubar=no,links=no,scrollbars=yes,toolbar=no,status=no");}else{f.getDims();f.animateResize(i,u,q,o,r,t);f.hideResizer();}return false;});a("#ri-sizer").live("click",function(i){i.preventDefault();if(a("#ri-sizes").is(":hidden")){f.showResizer();}else{f.hideResizer();}return false;});a("#ri-locate").live("click",function(i){i.preventDefault();var o=a(this);o=a(i.target);if(o.attr("data-arrow")==="d"){a("#ri-winDims").css({top:"auto",bottom:"0"});o.attr("data-arrow","u");o.html("&#9650;");}else{a("#ri-winDims").css({top:"0",bottom:"auto"});o.attr("data-arrow","d");o.html("&#9660;");}return false;});};f.settings={};f.init=function(){f.settings=a.extend({},h,b);if(!a("body").data("riWinDims")){f.firstInit();}else{throw new Error("You can only use this plugin once per page.");}};f.destroy=function(){a(window).unbind(".riWinDims");a(document).unbind(".riWinDims");d.remove();};f.init();};a.fn.riWinDims=function(b){return this.each(function(){if(undefined===a(this).data("riWinDims")){var c=new a.riWinDims(this,b);a(this).data("riWinDims",c);}});};}(jQuery));
